<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/tools/info.js - dwv</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="dwv"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.4.0beta</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Data reader.html">Data reader</a></li>
            
                <li><a href="../classes/DICOM tag dictionary..html">DICOM tag dictionary.</a></li>
            
                <li><a href="../classes/DicomParser class..html">DicomParser class.</a></li>
            
                <li><a href="../classes/dwv.math.Circle.html">dwv.math.Circle</a></li>
            
                <li><a href="../classes/dwv.math.Draw circle command..html">dwv.math.Draw circle command.</a></li>
            
                <li><a href="../classes/dwv.math.Drawing tool..html">dwv.math.Drawing tool.</a></li>
            
                <li><a href="../classes/dwv.math.FastPoint2D.html">dwv.math.FastPoint2D</a></li>
            
                <li><a href="../classes/dwv.math.Line shape..html">dwv.math.Line shape.</a></li>
            
                <li><a href="../classes/dwv.math.Path shape..html">dwv.math.Path shape.</a></li>
            
                <li><a href="../classes/dwv.math.Point2D.html">dwv.math.Point2D</a></li>
            
                <li><a href="../classes/dwv.math.Rectangle shape..html">dwv.math.Rectangle shape.</a></li>
            
                <li><a href="../classes/dwv.math.Region Of Interest shape.
Note: should be a closed path..html">dwv.math.Region Of Interest shape.
Note: should be a closed path.</a></li>
            
                <li><a href="../classes/Filter classes..App
Main application..html">Filter classes..App
Main application.</a></li>
            
                <li><a href="../classes/Filter classes..Draw line command..html">Filter classes..Draw line command.</a></li>
            
                <li><a href="../classes/Filter classes..Draw livewire command..html">Filter classes..Draw livewire command.</a></li>
            
                <li><a href="../classes/Filter classes..Draw rectangle command..html">Filter classes..Draw rectangle command.</a></li>
            
                <li><a href="../classes/Filter classes..Draw ROI command..html">Filter classes..Draw ROI command.</a></li>
            
                <li><a href="../classes/Filter classes..Filter tool..html">Filter classes..Filter tool.</a></li>
            
                <li><a href="../classes/Filter classes..Livewire painting tool..html">Filter classes..Livewire painting tool.</a></li>
            
                <li><a href="../classes/Filter classes..Run filter command..html">Filter classes..Run filter command.</a></li>
            
                <li><a href="../classes/Filter classes..Sharpen filter tool..html">Filter classes..Sharpen filter tool.</a></li>
            
                <li><a href="../classes/Filter classes..Sobel filter tool..html">Filter classes..Sobel filter tool.</a></li>
            
                <li><a href="../classes/Filter classes..Threshold filter tool..html">Filter classes..Threshold filter tool.</a></li>
            
                <li><a href="../classes/Filter classes..Tool box..html">Filter classes..Tool box.</a></li>
            
                <li><a href="../classes/Filter classes..UndoStack class..html">Filter classes..UndoStack class.</a></li>
            
                <li><a href="../classes/Filter classes..WindowLevel tool: handle window/level related events..html">Filter classes..WindowLevel tool: handle window/level related events.</a></li>
            
                <li><a href="../classes/Filter classes..Zoom class..html">Filter classes..Zoom class.</a></li>
            
                <li><a href="../classes/GUI classes..Circular Bucket Queue.

Returns input&#x27;d points in sorted order. All operations run in roughly O(1)
time (for input with small cost values), but it has a strict requirement:

If the most recent point had a cost of c, any points added should have a cost
c&#x27; in the range c &lt;= c&#x27; &lt;= c + (capacity - 1)..html">GUI classes..Circular Bucket Queue.

Returns input&#x27;d points in sorted order. All operations run in roughly O(1)
time (for input with small cost values), but it has a strict requirement:

If the most recent point had a cost of c, any points added should have a cost
c&#x27; in the range c &lt;= c&#x27; &lt;= c + (capacity - 1).</a></li>
            
                <li><a href="../classes/GUI classes..Image class..html">GUI classes..Image class.</a></li>
            
                <li><a href="../classes/GUI classes..Image Size class. 
Supports 2D and 3D images..html">GUI classes..Image Size class. 
Supports 2D and 3D images.</a></li>
            
                <li><a href="../classes/GUI classes..Image Spacing class. 
Supports 2D and 3D images..html">GUI classes..Image Spacing class. 
Supports 2D and 3D images.</a></li>
            
                <li><a href="../classes/GUI classes..Rescale LUT class..html">GUI classes..Rescale LUT class.</a></li>
            
                <li><a href="../classes/GUI classes..Scissors.

Ref: Eric N. Mortensen, William A. Barrett, Interactive Segmentation with
  Intelligent Scissors, Graphical Models and Image Processing, Volume 60,
  Issue 5, September 1998, Pages 349-384, ISSN 1077-3169,
  DOI: 10.1006/gmip.1998.0480.

(http://www.sciencedirect.com/science/article/B6WG4-45JB8WN-9/2/6fe59d8089fd1892c2bfb82283065579)

Highly inspired from http://code.google.com/p/livewire-javascript/.html">GUI classes..Scissors.

Ref: Eric N. Mortensen, William A. Barrett, Interactive Segmentation with
  Intelligent Scissors, Graphical Models and Image Processing, Volume 60,
  Issue 5, September 1998, Pages 349-384, ISSN 1077-3169,
  DOI: 10.1006/gmip.1998.0480.

(http://www.sciencedirect.com/science/article/B6WG4-45JB8WN-9/2/6fe59d8089fd1892c2bfb82283065579)

Highly inspired from http://code.google.com/p/livewire-javascript/</a></li>
            
                <li><a href="../classes/GUI classes..Style class..html">GUI classes..Style class.</a></li>
            
                <li><a href="../classes/GUI classes..View class..html">GUI classes..View class.</a></li>
            
                <li><a href="../classes/GUI classes..Window layer..html">GUI classes..Window layer.</a></li>
            
                <li><a href="../classes/GUI classes..Window LUT class..html">GUI classes..Window LUT class.</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/dwv.html">dwv</a></li>
            
                <li><a href="../modules/math.html">math</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/tools/info.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
//! @namespace Main DWV namespace.
var dwv = dwv || {};
// @namespace Info classes.
dwv.info = dwv.info || {};

/**
 * @function Create the windowing info div.
 */
dwv.info.createWindowingDiv = function()
{
    var div = document.getElementById(&quot;infotr&quot;);
    dwv.html.removeNode(&quot;ulinfotr&quot;);
    // windowing list
    var ul = document.createElement(&quot;ul&quot;);
    ul.id = &quot;ulinfotr&quot;;
    // window center list item
    var liwc = document.createElement(&quot;li&quot;);
    liwc.id = &quot;liwcinfotr&quot;;
    ul.appendChild(liwc);
    // window width list item
    var liww = document.createElement(&quot;li&quot;);
    liww.id = &quot;liwwinfotr&quot;;
    ul.appendChild(liww);
    // add list to div
    div.appendChild(ul);
};

/**
 * @function Update the Top Right info div.
 * @param event The windowing change event containing the new values.
 * Warning: expects the windowing info div to exist (use after createWindowingDiv).
 */
dwv.info.updateWindowingDiv = function(event)
{
    // window center list item
    var liwc = document.getElementById(&quot;liwcinfotr&quot;);
    dwv.html.cleanNode(liwc);
    liwc.appendChild(document.createTextNode(&quot;WindowCenter = &quot;+event.wc));
    // window width list item
    var liww = document.getElementById(&quot;liwwinfotr&quot;);
    dwv.html.cleanNode(liww);
    liww.appendChild(document.createTextNode(&quot;WindowWidth = &quot;+event.ww));
};

/**
 * @function Create the position info div.
 */
dwv.info.createPositionDiv = function()
{
    var div = document.getElementById(&quot;infotl&quot;);
    dwv.html.removeNode(&quot;ulinfotl&quot;);
    // position list
    var ul = document.createElement(&quot;ul&quot;);
    ul.id = &quot;ulinfotl&quot;;
    // position
    var lipos = document.createElement(&quot;li&quot;);
    lipos.id = &quot;liposinfotl&quot;;
    ul.appendChild(lipos);
    // value
    var livalue = document.createElement(&quot;li&quot;);
    livalue.id = &quot;livalueinfotl&quot;;
    ul.appendChild(livalue);
    // add list to div
    div.appendChild(ul);
};

/**
 * @function Update the position info div.
 * @param event The position change event containing the new values.
 * Warning: expects the position info div to exist (use after createPositionDiv).
 */
dwv.info.updatePositionDiv = function(event)
{
    // window center list item
    var lipos = document.getElementById(&quot;liposinfotl&quot;);
    dwv.html.cleanNode(lipos);
    lipos.appendChild(document.createTextNode(&quot;Pos = &quot;+event.i+&quot;, &quot;+event.j+&quot;, &quot;+event.k));
    // window width list item
    var livalue = document.getElementById(&quot;livalueinfotl&quot;);
    dwv.html.cleanNode(livalue);
    livalue.appendChild(document.createTextNode(&quot;Value = &quot;+event.value));
};

/**
 * @function Create the mini color map info div.
 */
dwv.info.createMiniColorMap = function()
{    
    // color map
    var div = document.getElementById(&quot;infobr&quot;);
    dwv.html.removeNode(&quot;canvasinfobr&quot;);
    var canvas = document.createElement(&quot;canvas&quot;);
    canvas.id = &quot;canvasinfobr&quot;;
    canvas.width = 98;
    canvas.height = 10;
    // add canvas to div
    div.appendChild(canvas);
};

/**
 * @function Update the mini color map info div.
 * @param event The windowing change event containing the new values.
 * Warning: expects the mini color map div to exist (use after createMiniColorMap).
 */
dwv.info.updateMiniColorMap = function(event)
{    
    var windowCenter = event.wc;
    var windowWidth = event.ww;
    
    var canvas = document.getElementById(&quot;canvasinfobr&quot;);
    context = canvas.getContext(&#x27;2d&#x27;);
    
    // fill in the image data
    var colourMap = app.getView().getColorMap();
    var imageData = context.getImageData(0,0,canvas.width, canvas.height);
    
    var c = 0;
    var minInt = app.getImage().getRescaledDataRange().min;
    var range = app.getImage().getRescaledDataRange().max - minInt;
    var incrC = range / canvas.width;
    var y = 0;
    
    var yMax = 255;
    var yMin = 0;
    var xMin = windowCenter - 0.5 - (windowWidth-1) / 2;
    var xMax = windowCenter - 0.5 + (windowWidth-1) / 2;    
    
    for( var j=0; j&lt;canvas.height; ++j ) {
        c = minInt;
        for( var i=0; i&lt;canvas.width; ++i ) {
            if( c &lt;= xMin ) y = yMin;
            else if( c &gt; xMax ) y = yMax;
            else {
                y = ( (c - (windowCenter-0.5) ) / (windowWidth-1) + 0.5 ) *
                    (yMax-yMin) + yMin;
                y = parseInt(y,10);
            }
            index = (i + j * canvas.width) * 4;
            imageData.data[index] = colourMap.red[y];
            imageData.data[index+1] = colourMap.green[y];
            imageData.data[index+2] = colourMap.blue[y];
            imageData.data[index+3] = 0xff;
            c += incrC;
        }
    }
    // put the image data in the context
    context.putImageData(imageData, 0, 0);
};

/**
 * @function Create the plot info.
 */
dwv.info.createPlot = function()
{
    $.plot($(&quot;#plot&quot;), [ app.getImage().getHistogram() ], {
        &quot;bars&quot;: { &quot;show&quot;: true },
        &quot;grid&quot;: { &quot;backgroundColor&quot;: null },
        &quot;xaxis&quot;: { &quot;show&quot;: true },
        &quot;yaxis&quot;: { &quot;show&quot;: false }
    });
};

/**
 * @function Update the plot markings.
 * @param event The windowing change event containing the new values.
 * Warning: expects the plot to exist (use after createPlot).
 */
dwv.info.updatePlotMarkings = function(event)
{
    var wc = event.wc;
    var ww = event.ww;
    
    var half = parseInt( (ww-1) / 2, 10 );
    var center = parseInt( (wc-0.5), 10 );
    var min = center - half;
    var max = center + half;
    
    var markings = [
        { &quot;color&quot;: &quot;#faa&quot;, &quot;lineWidth&quot;: 1, &quot;xaxis&quot;: { &quot;from&quot;: min, &quot;to&quot;: min } },
        { &quot;color&quot;: &quot;#aaf&quot;, &quot;lineWidth&quot;: 1, &quot;xaxis&quot;: { &quot;from&quot;: max, &quot;to&quot;: max } }
    ];

    $.plot($(&quot;#plot&quot;), [ app.getImage().getHistogram() ], {
        &quot;bars&quot;: { &quot;show&quot;: true },
        &quot;grid&quot;: { &quot;markings&quot;: markings, &quot;backgroundColor&quot;: null },
        &quot;xaxis&quot;: { &quot;show&quot;: false },
        &quot;yaxis&quot;: { &quot;show&quot;: false }
    });
};

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
