!function(){"use strict";class t{#t;#e;#s;constructor(t,e,s){this.#t=t,this.#e=e,this.#s=s}getX(){return this.#t}getY(){return this.#e}getZ(){return this.#s}equals(t){return null!==t&&this.#t===t.getX()&&this.#e===t.getY()&&this.#s===t.getZ()}toString(){return"("+this.#t+", "+this.#e+", "+this.#s+")"}norm(){return Math.sqrt(this.#t*this.#t+this.#e*this.#e+this.#s*this.#s)}crossProduct(e){return new t(this.#e*e.getZ()-e.getY()*this.#s,this.#s*e.getX()-e.getZ()*this.#t,this.#t*e.getY()-e.getX()*this.#e)}dotProduct(t){return this.#t*t.getX()+this.#e*t.getY()+this.#s*t.getZ()}isCodirectional(t){return this.dotProduct(t)>0}}class e{#t;#e;#s;constructor(t,e,s){this.#t=t,this.#e=e,this.#s=s}getX(){return this.#t}getY(){return this.#e}getZ(){return this.#s}getValues(){return[this.#t,this.#e,this.#s]}equals(t){return null!==t&&this.#t===t.getX()&&this.#e===t.getY()&&this.#s===t.getZ()}isSimilar(t,e){return null!==t&&n(this.#t,t.getX(),e)&&n(this.#e,t.getY(),e)&&n(this.#s,t.getZ(),e)}toString(){return"("+this.#t+", "+this.#e+", "+this.#s+")"}getDistance(t){return Math.sqrt(this.#r(t))}#r(t){const e=this.#t-t.getX(),s=this.#e-t.getY(),r=this.#s-t.getZ();return e*e+s*s+r*r}getClosest(t){let e=0,s=this.#r(t[e]);for(let r=0;r<t.length;++r){const i=this.#r(t[r]);i<s&&(e=r,s=i)}return e}minus(e){return new t(this.#t-e.getX(),this.#e-e.getY(),this.#s-e.getZ())}}class s{#i;constructor(t){if(!t||void 0===t)throw new Error("Cannot create index with no values.");if(0===t.length)throw new Error("Cannot create index with empty values.");if(!t.every((function(t){return!isNaN(t)})))throw new Error("Cannot create index with non number values.");this.#i=t}get(t){return this.#i[t]}length(){return this.#i.length}toString(){return"("+this.#i.toString()+")"}getValues(){return this.#i.slice()}canCompare(t){return!!t&&this.length()===t.length()}equals(t){if(!this.canCompare(t))return!1;for(let e=0,s=this.length();e<s;++e)if(this.get(e)!==t.get(e))return!1;return!0}compare(t){if(!this.canCompare(t))return null;const e=[];for(let s=0,r=this.length();s<r;++s)this.get(s)!==t.get(s)&&e.push(s);return e}add(t){if(!this.canCompare(t))return null;const e=[];for(let s=0,r=this.length();s<r;++s)e.push(this.get(s)+t.get(s));return new s(e)}#n(t,e){const r=this.#i.slice();return t<r.length?r[t]+=e:console.warn("Cannot add to given dimension: ",t,r.length),new s(r)}next(t){return this.#n(t,1)}previous(t){return this.#n(t,-1)}getWithNew2D(t,e){const r=[t,e];for(let t=2,e=this.length();t<e;++t)r.push(this.get(t));return new s(r)}}const r={levels:{TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4},level:3,trace:function(t){this.level<=this.levels.TRACE&&console.trace(t)},debug:function(t){this.level<=this.levels.DEBUG&&console.debug(t)},info:function(t){this.level<=this.levels.INFO&&console.info(t)},warn:function(t){this.level<=this.levels.WARN&&console.warn(t)},error:function(t){this.level<=this.levels.ERROR&&console.error(t)}},i=1e4*Number.EPSILON;function n(t,e,s){return void 0===s&&(s=Number.EPSILON),Math.abs(t-e)<s}class h{#i;#h;constructor(t){this.#i=t}get(t,e){return this.#i[3*t+e]}getInverse(){return void 0===this.#h&&(this.#h=function(t){const e=t.get(0,0),s=t.get(0,1),i=t.get(0,2),n=t.get(1,0),u=t.get(1,1),a=t.get(1,2),l=t.get(2,0),o=t.get(2,1),g=t.get(2,2),c=u*g-a*o,f=a*l-n*g,v=n*o-u*l;let d=e*c+s*f+i*v;if(0!==d)return d=1/d,new h([d*c,d*(i*o-s*g),d*(s*a-i*u),d*f,d*(e*g-i*l),d*(i*n-e*a),d*v,d*(s*l-e*o),d*(e*u-s*n)]);r.warn("Cannot invert 3*3 matrix with zero determinant.")}(this)),this.#h}equals(t){for(let e=0;e<3;++e)for(let s=0;s<3;++s)if(this.get(e,s)!==t.get(e,s))return!1;return!0}isSimilar(t,e){for(let s=0;s<3;++s)for(let r=0;r<3;++r)if(!n(this.get(s,r),t.get(s,r),e))return!1;return!0}toString(){let t="[";for(let e=0;e<3;++e){0!==e&&(t+=", \n ");for(let s=0;s<3;++s)0!==s&&(t+=", "),t+=this.get(e,s)}return t+="]",t}multiply(t){const e=[];for(let s=0;s<3;++s)for(let r=0;r<3;++r){let i=0;for(let e=0;e<3;++e)i+=this.get(s,e)*t.get(e,r);e.push(i)}return new h(e)}getAbs(){const t=[];for(let e=0;e<3;++e)for(let s=0;s<3;++s)t.push(Math.abs(this.get(e,s)));return new h(t)}multiplyArray3D(t){if(3!==t.length)throw new Error("Cannot multiply 3x3 matrix with non 3D array: "+t.length);const e=t[0],s=t[1],r=t[2],i=new Array(3);return i[0]=this.#i[0]*e+this.#i[1]*s+this.#i[2]*r,i[1]=this.#i[3]*e+this.#i[4]*s+this.#i[5]*r,i[2]=this.#i[6]*e+this.#i[7]*s+this.#i[8]*r,i}multiplyTypedArray3D(t,e){const s=t[0],r=t[1],i=t[2];e[0]=this.#i[0]*s+this.#i[1]*r+this.#i[2]*i,e[1]=this.#i[3]*s+this.#i[4]*r+this.#i[5]*i,e[2]=this.#i[6]*s+this.#i[7]*r+this.#i[8]*i}multiplyVector3D(e){const s=this.multiplyArray3D([e.getX(),e.getY(),e.getZ()]);return new t(s[0],s[1],s[2])}multiplyPoint3D(t){const s=this.multiplyArray3D([t.getX(),t.getY(),t.getZ()]);return new e(s[0],s[1],s[2])}multiplyIndex3D(t){const e=this.multiplyArray3D(t.getValues());return new s(e)}getRowAbsMax(t){const e=[Math.abs(this.get(t,0)),Math.abs(this.get(t,1)),Math.abs(this.get(t,2))],s=Math.max.apply(null,e),r=e.indexOf(s);return{value:this.get(t,r),index:r}}getColAbsMax(t){const e=[Math.abs(this.get(0,t)),Math.abs(this.get(1,t)),Math.abs(this.get(2,t))],s=Math.max.apply(null,e),r=e.indexOf(s);return{value:this.get(r,t),index:r}}asOneAndZeros(){const t=[];for(let e=0;e<3;++e){const s=this.getRowAbsMax(e),r=s.value>0?1:-1;for(let e=0;e<3;++e)e===s.index?t.push(1*r):t.push(0)}return new h(t)}getThirdColMajorDirection(){return this.getColAbsMax(2).index}getValues(){return this.#i.slice()}}class u{#u;#a;#l;#o(t,e,s){const r=Math.floor(t),i=Math.floor(e),n=Math.floor(s),h=r<0?0:r,u=r+1>=this.#a[0]?r:r+1,a=i<0?0:i,l=i+1>=this.#a[1]?i:i+1,o=n<0?0:n,g=n+1>=this.#a[2]?n:n+1,c=h*this.#l[0],f=u*this.#l[0],v=a*this.#l[1],d=l*this.#l[1],y=o*this.#l[2],p=g*this.#l[2],m=c+v+y,x=c+v+p,w=c+d+y,b=c+d+p,z=f+v+y,M=f+v+p,D=f+d+y,S=f+d+p,A=h>=0&&h<this.#a[0],R=u>=0&&u<this.#a[0],C=a>=0&&a<this.#a[1],V=l>=0&&l<this.#a[1],E=o>=0&&o<this.#a[2],Z=g>=0&&g<this.#a[2],X=A&&C&&E?this.#u[m]:0,Y=A&&C&&Z?this.#u[x]:0,I=A&&V&&E?this.#u[w]:0,N=A&&V&&Z?this.#u[b]:0,O=R&&C&&E?this.#u[z]:0,q=R&&C&&Z?this.#u[M]:0,T=R&&V&&E?this.#u[D]:0,B=R&&V&&Z?this.#u[S]:0,P=Math.abs(t-r),U=Math.abs(e-i),L=Math.abs(s-n),W=1-P,F=1-U,G=1-L;return X*(W*F*G)+Y*(W*F*L)+I*(W*U*G)+N*(W*U*L)+O*(P*F*G)+q*(P*F*L)+T*(P*U*G)+B*(P*U*L)}#g(t){const e=Math.round(t);return Math.abs(t-e)<i?e:t}calculateResample(t){const e=t.sourceSize,s=t.targetSize,r=t.sourceUnitVectors,i=t.targetUnitVectors,n=t.sourceSpacing,u=t.targetSpacing;this.#u=t.sourceImageBuffer,this.#a=t.sourceSize,this.#l=r;const a=t.interpolate,l=new h(t.sourceOrientation),o=new h(t.targetOrientation),g=l.getInverse(),c=o.multiply(g),f=[(s[0]-1)/2,(s[1]-1)/2,(s[2]-1)/2],v=[(e[0]-1)/2,(e[1]-1)/2,(e[2]-1)/2],d=new Array(3),y=new Array(3);let p,m,x,w,b,z;for(let h=0;h<s[0];h++){d[0]=(h-f[0])*u[0],w=i[0]*h;for(let h=0;h<s[1];h++){d[1]=(h-f[1])*u[1],b=w+i[1]*h;for(let h=0;h<s[2];h++)if(d[2]=(h-f[2])*u[2],c.multiplyTypedArray3D(d,y),p=this.#g(y[0]/n[0]+v[0]),m=this.#g(y[1]/n[1]+v[1]),x=this.#g(y[2]/n[2]+v[2]),p>=0&&p<e[0]&&m>=0&&m<e[1]&&x>=0&&x<e[2])if(z=b+i[2]*h,a)t.targetImageBuffer[z]=this.#o(p,m,x);else{const e=r[0]*Math.round(p)+r[1]*Math.round(m)+r[2]*Math.round(x);t.targetImageBuffer[z]=t.sourceImageBuffer[e]}}}}}self.addEventListener("message",(function(t){(new u).calculateResample(t.data),self.postMessage(t.data)}),!1)}();
//# sourceMappingURL=resampling.worker.min.js.map