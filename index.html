<html>

<head>
<title>DICOM Web Viewer</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<link rel="stylesheet" href="css/style.css">
<style>
body { font-size: 80%; }
#toolbox li:first-child { list-style-type: none; padding-bottom: 10px; margin-left: -20px; }
#pageMain { height: 85%; width: 100%; margin-top: 10px; }
#plot { bottom: 40px; right: 20px; }
</style>
<link rel="stylesheet" href="ext/jquery/ui/1.10.1/themes/ui-darkness/jquery-ui.min.css">
<!-- Third party -->  
<script type="text/javascript" src="ext/jquery/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="ext/jquery/ui/1.10.1/jquery-ui.min.js"></script>
<script type="text/javascript" src="ext/flot/jquery.flot.min.js"></script>
<!-- Local -->
<script type="text/javascript" src="src/dwv.js"></script>
<script type="text/javascript" src="src/application.js"></script>
<script type="text/javascript" src="src/dicom/dicomParser.js"></script>
<script type="text/javascript" src="src/dicom/dictionary.js"></script>
<script type="text/javascript" src="src/html/gui.js"></script>
<script type="text/javascript" src="src/html/gui_ui.js"></script>
<script type="text/javascript" src="src/html/html.js"></script>
<script type="text/javascript" src="src/html/style.js"></script>
<script type="text/javascript" src="src/html/layer.js"></script>
<script type="text/javascript" src="src/image/filter.js"></script>
<script type="text/javascript" src="src/image/image.js"></script>
<script type="text/javascript" src="src/image/luts.js"></script>
<script type="text/javascript" src="src/image/reader.js"></script>
<script type="text/javascript" src="src/math/shapes.js"></script>
<script type="text/javascript" src="src/math/bucketQueue.js"></script>
<script type="text/javascript" src="src/math/scissors.js"></script>
<script type="text/javascript" src="src/utils/string.js"></script>

<!-- Tools: beware order is important... -->
<script type="text/javascript" src="src/tools/toolbox.js"></script>
<script type="text/javascript" src="src/tools/windowLevel.js"></script>
<script type="text/javascript" src="src/tools/draw.js"></script>
<script type="text/javascript" src="src/tools/line.js"></script>
<script type="text/javascript" src="src/tools/rectangle.js"></script>
<script type="text/javascript" src="src/tools/roi.js"></script>
<script type="text/javascript" src="src/tools/circle.js"></script>
<script type="text/javascript" src="src/tools/livewire.js"></script>
<script type="text/javascript" src="src/tools/zoom.js"></script>
<script type="text/javascript" src="src/tools/filter.js"></script>
<script type="text/javascript" src="src/tools/undo.js"></script>

<script type="text/javascript">

function toggle(dialogName)
{
    if( $(dialogName).dialog('isOpen') )
    {
        $(dialogName).dialog('close');
    }
    else
    {
        $(dialogName).dialog('open');
    }
}

// main application
var app = new dwv.App();

// jquery
$(document).ready(function(){
    // create buttons and dialogs
    $("button").button();
    $("#openData").dialog({ position: 
        {my: "left top", at: "left top", of: "#pageMain"} });
    $("#toolbox").dialog({ position: 
        {my: "left top+200", at: "left top", of: "#pageMain"} });
    $("#history").dialog({ position: 
        {my: "left top+370", at: "left top", of: "#pageMain"},
        autoOpen: false });
    $("#tags").dialog({ position: 
        {my: "right top", at: "right top", of: "#pageMain"},
        autoOpen: false, width: 500, height: 590 });
    
    // image dialog
    $("#layerDialog").dialog({ position: 
        {my: "left+320 top", at: "left top", of: "#pageMain"}});
    // default size
    $("#layerDialog").dialog({ width: "auto", resizable: false });
    // Resizable but keep aspect ratio
    // TODO it seems to add a border that bothers getting the cursor position...
    //$("#layerContainer").resizable({ aspectRatio: true });
    
    // initialise the application
    app.init();
    // align layers when the window is resized
    window.onresize = app.resize;
    // possible load from URL
    var input = dwv.html.getUriParam("input"); 
    if( input ) app.loadURL(decodeURIComponent(input));
});
</script>
</head>

<body>

<div id="pageHeader">

<!-- Title -->
<h1>DICOM Web Viewer (<a href="https://github.com/ivmartel/dwv">dwv</a> v0.3b)</h1>

<!-- Buttons -->
<button onclick="toggle('#openData')">File</button>
<button onclick="toggle('#toolbox')">Toolbox</button>
<button onclick="toggle('#history')">History</button>
<button onclick="toggle('#tags')">Tags</button>
<button onclick="toggle('#layerDialog')">Image</button>

</div><!-- pageHeader -->

<div id="pageMain">

<!-- Open file -->
<div id="openData" title="File">
<form><p>
Path: <input type="file" id="imagefiles" multiple />
URL: <input type="url" id="imageurl" />
</p></form>
<div id="progressbar"></div>
</div>

<!-- Toolbox -->
<div id="toolbox" title="Toolbox">
<ul id="toolList"></ul>
</div>

<!-- History -->
<div id="history" title="History"></div>

<!-- Tags -->
<div id="tags" title="Tags" style="display:none;"></div>

<!-- Layer Container -->
<div id="layerDialog" title="Image">
<div id="layerContainer">
<canvas id="imageLayer">Only for HTML5 compatible browsers...</canvas>
<canvas id="drawLayer">Only for HTML5 compatible browsers...</canvas>
<canvas id="infoLayer">Only for HTML5 compatible browsers...</canvas>
<canvas id="tempLayer">Only for HTML5 compatible browsers...</canvas>
<div id="plot"></div>
</div>
</div>

</div><!-- pageMain -->

</body>
</html>
